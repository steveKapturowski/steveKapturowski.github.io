<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>MCMC, Renormalization, and the Ising Model &#8211; Strange Matter - A fledgeling blog about math, machine learning, and black holes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The Ising model is a simplified description of ferromagnetism where spin-up and spin-down states sit on a d-dimensional lattice with an interaction defined between spins on neighboring sites. In one and two dimensions this model is analytically soluble, but because of that it makes a perfect playground to learn about Markov Chain Monte Carlo methods; a powerful tool with diverse applications in Bayesian statistics, statistical mechanics, and quantum field theory.">
    <meta name="author" content="Steven Kapturowski">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://blog.stevenkapturowski.com/ising-model">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    


    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="MCMC, Renormalization, and the Ising Model">
    <meta property="og:description" content="">
    <meta property="og:url" content="http://blog.stevenkapturowski.com/ising-model">
    <meta property="og:site_name" content="Strange Matter - A fledgeling blog about math, machine learning, and black holes">

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="images/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="images/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="images/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="images/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="images/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="images/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="images/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32">
</head>

<body class="">
  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://blog.stevenkapturowski.com" class="site-title">Strange Matter - A fledgeling blog about math, machine learning, and black holes</a>
      <nav class="site-nav right">
        <a href="/about/">About</a>
<a href="/contact/">Contact</a>

      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="left">
    
      <a class="fa fa-github" href="https://github.com/steveKapturowski"></a>
    
    
    <a class="fa fa-rss" href="/feed.xml"></a>
    
    
    
      <a class="fa fa-envelope" href="mailto:myrealnamewascensored@gmail.com"></a>
    
    
      <a class="fa fa-linkedin" href="https://www.linkedin.com/in/stevenkapturowski"></a>
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>MCMC, Renormalization, and the Ising Model</h1>
  <span class="post-meta">May 1, 2015</span><br>
  
  <span class="post-meta small">7 minute read</span>
</div>

<article class="post-content">
  <center>
<video width="300" height="240" controls="">
	<source src="/videos/ising.m4v" type="video/mp4" />
	Your browser does not support the video tag.
</video>
</center>

<p>The Ising model is a simplified description of ferromagnetism where spin-up and spin-down states sit on a d-dimensional lattice with an interaction defined between spins on neighboring sites. In one and two dimensions this model is analytically soluble, but because of that it makes a perfect playground to learn about Markov Chain Monte Carlo methods; a powerful tool with diverse applications in Bayesian statistics, statistical mechanics, and quantum field theory.</p>

<h2 id="solving-the-ising-model-in-1d">Solving the Ising Model in 1D</h2>

<script type="math/tex; mode=display"> H = -\sum K_{ij}\sigma_i\sigma_j - \mu\sum J_i\sigma_i </script>

<script type="math/tex; mode=display"> Z = \sum_{\{\sigma\}} e^{-\beta H}</script>

<p>As it turns out we have very nice formulas for energy, specific heat, magnetization, and susceptibility respectively: <script type="math/tex">E = -\frac{\partial\ln Z}{\partial \beta} </script>, <script type="math/tex">c_v = k\beta^2 \frac{\partial^2\ln Z}{\partial \beta^2}</script>, <script type="math/tex">M = -\frac{\partial\ln Z}{\partial J} \biggr\rvert_{J=0}</script>, and <script type="math/tex">\chi = -\frac{\partial^2\ln Z}{\partial J^2} \biggr\rvert_{J=0}</script>as well as the correlation functions, all in terms of the partition function <script type="math/tex">Z</script>. So, in principle, if we know the partition function, we know <i>everything</i></p>

<p>The problem is that the number of terms in the sum is exponential in the number of states <script type="math/tex">\sigma</script>. There are two ways to deal with the situation: 1) figure out some fancy tricks to ananlytically coerce this unwieldy beast into submission, or 2) use numerical techniques which exploit the fact that only a relatively small number of states contribute appreciably to the partition function. Here, we’ll do both.</p>

<p>Let’s start with (1):</p>

<p>Let N be the length of the lattice in each direction and assume periodic boundary conditions such that <script type="math/tex">\sigma_{N}</script> neighbors <script type="math/tex">\sigma_{1}</script>. For simplicity let’s also turn off the external magnetic field (<script type="math/tex">h=0</script>). </p>

<script type="math/tex; mode=display">Z = \sum_{\{\sigma\}} e^{K\sigma_N \sigma_1} \prod_{k=1}^{N-1} e^{K\sigma_k \sigma_{k+1}}</script>

<p>Defining the <i>transfer matrix</i>:</p>

<script type="math/tex; mode=display">% <![CDATA[
 T_{\sigma_k \sigma_{k+1}} =
\begin{bmatrix}
    e^K    & e^{-K} \\
    e^{-K} & e^K \\
\end{bmatrix}
 %]]></script>

<p>we can rewrite the partition function as follows:</p>

<script type="math/tex; mode=display"> Z = \mbox{Tr}T^N = \lambda_1^N + \lambda_2^N </script>

<p>Diagonalizing <script type="math/tex">T</script> we find eigenvalues <script type="math/tex">\lambda_1 = 2\cosh K</script> and <script type="math/tex">\lambda_2 = 2\sinh K</script></p>

<p>So we end up with the particularly simple form:</p>

<script type="math/tex; mode=display"> Z = (2\cosh K)^N + (2\sinh K)^N </script>

<h2 id="criticality">Criticality</h2>

<p>The full solution in two dimensions is very complicated to derive (apparently it took Richard Feynman 14 pages to explain it in his lectures on statistical mechanics). I won’t endeavor to try your patience to such an extent, but fortunately we can find the critical temperature in a slightly less painful manner, using a result called <a href="http://en.wikipedia.org/wiki/Kramers%E2%80%93Wannier_duality">Kramers-Wannier Duality</a>:</p>

<script type="math/tex; mode=display"> \sum_{\{P\}} \tanh(\beta \hat{K})^{L(P)} = \sum_{\{P\}} e^{-2\beta K L(P)}
</script>

<p>Where the sums are over all (possibly disconnected) domain wall paths and <script type="math/tex">L(P)</script> is the length of the path. Equating the sums term-by-term we find a mapping between high temperatures and low temperatures:</p>

<script type="math/tex; mode=display">\tanh(\beta \hat{K}) \leftrightarrow e^{-2\beta K}</script>

<p>Under this mapping critical points must be mapped to critical points; so under the assumption that the system contains only one phase transition, <i>it must be mapped to itself</i>. Thus:</p>

<script type="math/tex; mode=display">\sinh(2K_c) = 1</script>

<p>Manipulating the sinh term we get a polynomial in <script type="math/tex">\chi = e^{2K_c}</script>:</p>

<script type="math/tex; mode=display">2\chi - \chi^2 - 1 = 0</script>

<p>Finally we end up with a critical temperature at:</p>

<script type="math/tex; mode=display"> T_c = \frac{2J}{k \ln(1+\sqrt2)} </script>

<h2 id="the-metropolis-algorithm">The Metropolis Algorithm</h2>

<p>Every physics treatment of this algorithm that I’ve read feels as if it’s described backwards, so I’m going to try doing things a bit differently.</p>

<p>The overall idea is to build a markov chain whose equilibrium distribution of states matches the partition function. Let <script type="math/tex">P</script> denote the <script type="math/tex">2^Sx2^S</script> transition matrix where <script type="math/tex">S</script> is the number of lattice sites and whose entries <script type="math/tex">P_{AB}</script> represent the probability of transitioning from state <script type="math/tex">A</script> to state <script type="math/tex">B</script>.</p>

<p>A <i>sufficient</i>, but not <i>necessary</i>, condition for the Markov chain to be in equilibrium is for it to satisfy the <a href="http://en.wikipedia.org/wiki/Detailed_balance"><i>detailed balance</i></a> condition: </p>

<script type="math/tex; mode=display"> \pi_A P_{AB} = \pi_B P_{BA}</script>

<p>where <script type="math/tex">\pi</script> is the probability distribution over states. Since we want <script type="math/tex">\pi</script> to give the partition function, we must have <script type="math/tex">\pi_A = \frac{1}{Z}e^{-\beta E_A}</script>. Thus: </p>

<script type="math/tex; mode=display"> \frac{\pi_A}{\pi_B} = \frac{P_{BA}}{P_{AB}} = e^{\beta[E_B-E_A]} </script>

<p>We have some freedom in choosing transition probabilities, they just need to satisfy this equation. So let’s define:</p>

<script type="math/tex; mode=display">P_{AB} = \frac{1}{S} \mathcal{A}_{AB}</script>

<script type="math/tex; mode=display">% <![CDATA[

\mathcal{A}_{AB} = \left\{
     \begin{array}{lr}
       e^{\beta[E_B-E_A]} & : B < A\\
       1 & : otherwise
     \end{array}
   \right.
 %]]></script>

<p>for <script type="math/tex">A \neq B</script> being nearest neighbors and <script type="math/tex">0</script> otherwise. Finally, the requirement that <script type="math/tex">P</script> be a stochastic matrix fixes <script type="math/tex">P_{AA} = 1 - \sum_{B \neq A}P_{AB} </script>. </p>

<p>Now that we know all this, we can finally define the <a href="http://en.wikipedia.org/wiki/Metropolis%E2%80%93Hastings_algorithm"><i>Metropolis Algorithm</i></a>:</p>

<ol>
  <li>initialize lattice with some spin configuration <script type="math/tex">\{\sigma\}</script></li>
  <li>choose <script type="math/tex">\sigma_i</script> uniformly at random (drawing from <script type="math/tex">p(\sigma_i) = \frac{1}{S}</script>)</li>
  <li>set <script type="math/tex">\sigma_i := - \sigma_i</script> defining the transition <script type="math/tex">A \rightarrow B</script></li>
  <li>accept new state with probability <script type="math/tex">\mathcal{A}_{AB}</script></li>
  <li>if new state is rejected reset <script type="math/tex">\sigma_i</script> to its previous state</li>
  <li>proceed to step (1)</li>
</ol>

<p>Since the algorithm initializes the spins in an arbitrary configuration there is a certain thermalization time needed before the system actually reaches equilibrium. Once equilibrium <i>is</i> reached we can treat subsequent states as draws from the partition function. We will generally want each draw to be independent from the previous draw. To achieve this we can simply experiment to find a fixed number of iterations between draws for which the correlations are sufficiently close to zero.</p>

<h2 id="a-curious-link-to-quantum-field-theory">A Curious Link to Quantum Field Theory</h2>

<p>The starting point for most quantum field theory is the path integral, such as this one describing a real scalar field:</p>

<script type="math/tex; mode=display"> Z = \int \mathcal{D}\phi e^{\frac{i}{h}\int dx^4 [\frac{1}{2}\partial_\mu\phi\partial^\mu\phi - \frac{1}{2}m^2\phi^2 - V(\phi)]} </script>

<p>Fancifully put, a real scalar field is just the physics in the continuum limit of an infinitely large mattress. </p>

<p>The path integral is essentially a sum over all paths in spacetime. The notation of <script type="math/tex">\partial_\mu\phi\partial^\mu\phi</script> with <a href="http://en.wikipedia.org/wiki/Einstein_notation">one index raised and one lowered</a> encodes the metric of <a href="http://en.wikipedia.org/wiki/Minkowski_space">Minkowski space</a>. Described using this geometry the physics of special relativity essentially all boils down to the fact that you can convert space and time into each other by rotating through an imaginary angle. </p>

<p>Since the functions being described here are analytic we can <a href="http://en.wikipedia.org/wiki/Wick_rotation"><i>rotate into imaginary time</i></a> to do our calculations in euclidean space and then use <a href="http://en.wikipedia.org/wiki/Analytic_continuation">analytic continuation</a> to put our results back into ordinary spacetime.</p>

<p>But when you rotate into Euclidean space the exponent gets shuffled around:</p>

<script type="math/tex; mode=display"> Z = \int \mathcal{D}\phi e^{-\frac{1}{\hbar}\int dx^4 [\frac{1}{2}\delta^{\mu\nu}\partial_\mu\phi\partial_\nu\phi + \frac{1}{2}m^2\phi^2 + V(\phi)]}
= \int \mathcal{D}\phi e^{-\frac{1}{\hbar} H[\phi]} </script>

<p>If you identify <script type="math/tex">\beta \leftrightarrow 1/\hbar</script> this is exactly analogous to the partition function in statistical mechanics. This is an example of a <i>duality</i>: every problem in quantum field theory has a corresponding problem in statistical mechanics, and vice versa. This greatly expands the variety of techniques at our disposal and has proven to be a powerful tool in physics. In particular the MCMC simulation we used here can be applied to quantum field theories and has been critical to understanding the <a href="http://en.wikipedia.org/wiki/Lattice_QCD">nonperturbative aspects of quantum chromodynamics</a>. But that’s for a future post…</p>

<h2 id="links-and-resources">Links and Resources</h2>

<p><a href="https://github.com/steveKapturowski/QFT_Project">[1] Source code</a></p>

<p><a href="http://micro.stanford.edu/~caiwei/me334/Chap12_Ising_Model_v04.pdf">[2] Stanford Handout on the Ising Model</a></p>

<p><a href="http://math.arizona.edu/~tgk/541/chap3.pdf">[3] The Renormalization Group for Ising Spins</a></p>

<p><a href="http://arxiv.org/pdf/hep-lat/0506036v1.pdf">[4] Lattice QCD for Novices</a></p>

</article>


  <div class="share-page">
  Share this post!

  <div class="share-links">
    

    
      <a class="fa fa-twitter" href="https://twitter.com/intent/tweet?text=MCMC, Renormalization, and the Ising Model&url=http://blog.stevenkapturowski.com/ising-model" rel="nofollow" target="_blank" title="Share on Twitter"></a>
    

    

    

    

    

    
      <a class="fa fa-reddit" href="http://reddit.com/submit?url=http://blog.stevenkapturowski.com/ising-model&title=MCMC, Renormalization, and the Ising Model" rel="nofollow" target="_blank" title="Share on Reddit"></a>
    

    

    
      <a class = "fa fa-hacker-news" onclick="parent.postMessage('submit','*')" href="https://news.ycombinator.com/submitlink?u=http://blog.stevenkapturowski.com/ising-model&t=MCMC, Renormalization, and the Ising Model" rel="nofollow" target="_blank" title="Share on Hacker News"></a>
    


  </div>
</div>









      </div>
    </div>
  </div>

  

</body>
</html>

<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

